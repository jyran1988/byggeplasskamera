version: "3.8"
services:
  fetcher:
    build: .
    restart: unless-stopped
    environment:
      - IMAGE_URL=https://kunde.byggekamera.no/?u=nytt-sykehus-aker&c=1059
      - INTERVAL_SECONDS=${INTERVAL_SECONDS:-3600}
      - STORAGE_DIR=/data/images
    volumes:
      - ./data:/data
    command: python -u src/fetcher.py

  web:
    build: .
    restart: unless-stopped
    environment:
      - STORAGE_DIR=/data/images
    volumes:
      - ./data:/data
    ports:
      - "80:5000"
    command: python -u src/web_server.py
    depends_on:
      - fetcher
